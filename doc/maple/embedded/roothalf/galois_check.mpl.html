<html>
 <head>
 </head>
 <body>
  <pre>
    <a name="line_1"></a>check_galois := proc()
<a name="line_2"></a> local i,j,chi,xi,ok,m0,m1,T;
<a name="line_3"></a>
<a name="line_4"></a> printf("%a()\n",procname);
<a name="line_5"></a>
<a name="line_6"></a> for i from 1 to 16 do
<a name="line_7"></a>  _ASSERT(FNF_y0(eval(subs(t=tx,st[i])) - sx[i]) = 0,
<a name="line_8"></a>          sprintf("s[%d] in terms of x,y,r",i));
<a name="line_9"></a> od:
<a name="line_10"></a>
<a name="line_11"></a> _ASSERT(
<a name="line_12"></a> {seq(seq(
<a name="line_13"></a>   FNF_y0(act_AT[T](t_xyz_reduce(t[i])) - t_xyz_reduce(act_AT[T](t[i]))),
<a name="line_14"></a>  T in {L,M,N,A1,A2}),i=1..4)} = {0},
<a name="line_15"></a>  "Action of G64 on t[i] vs tx[i]"
<a name="line_16"></a> );
<a name="line_17"></a>
<a name="line_18"></a> _ASSERT(
<a name="line_19"></a> {seq(seq(
<a name="line_20"></a>   FNF_y0(act_AT[T](t_xyz_reduce(s[i])) - t_xyz_reduce(act_AT[T](s[i]))),
<a name="line_21"></a>  T in {L,M,N,A1,A2}),i=1..16)} = {0},
<a name="line_22"></a>  "Action of G64 on s[i] vs sx[i]"
<a name="line_23"></a> );
<a name="line_24"></a>
<a name="line_25"></a> _ASSERT(
<a name="line_26"></a> {seq(seq(
<a name="line_27"></a>   FNF_y0(act_AT[T](t_xyz_reduce(u[i])) - t_xyz_reduce(act_AT[T](u[i]))),
<a name="line_28"></a>  T in {L,M,N,A1,A2}),i=1..16)} = {0},
<a name="line_29"></a>  "Action of G64 on u[i] vs ux[i]"
<a name="line_30"></a> );
<a name="line_31"></a>
<a name="line_32"></a>_ASSERT(
<a name="line_33"></a>  {seq(t_xyz_reduce(t_rels[i]),i=1..2)} = {0},
<a name="line_34"></a>  "t_rels = 0"
<a name="line_35"></a> );
<a name="line_36"></a>
<a name="line_37"></a> _ASSERT(
<a name="line_38"></a>  {seq(t_xyz_reduce(s_rels[i]),i=1..2)} = {0},
<a name="line_39"></a>  "s_rels = 0"
<a name="line_40"></a> );
<a name="line_41"></a>
<a name="line_42"></a> _ASSERT(
<a name="line_43"></a>  {seq(t_xyz_reduce(ts_rels[i]),i=1..4)} = {0},
<a name="line_44"></a>  "ts_rels = 0"
<a name="line_45"></a> );
<a name="line_46"></a>
<a name="line_47"></a> _ASSERT(
<a name="line_48"></a>  {seq(t_xyz_reduce(qt_rels[i]),i=1..4)} = {0},
<a name="line_49"></a>  "qt_rels = 0 (quadratic relations for t[i] over K)"
<a name="line_50"></a> );
<a name="line_51"></a>
<a name="line_52"></a> _ASSERT(
<a name="line_53"></a>  map(t_xyz_reduce,u_lin_rels) = {0},
<a name="line_54"></a>  "u_lin_rels = 0"
<a name="line_55"></a> );
<a name="line_56"></a>
<a name="line_57"></a> _ASSERT(
<a name="line_58"></a>  map(t_xyz_reduce,u_quad_rels) = {0},
<a name="line_59"></a>  "u_quad_rels = 0"
<a name="line_60"></a> );
<a name="line_61"></a>
<a name="line_62"></a> _ASSERT(
<a name="line_63"></a>  {seq(t_xyz_reduce(u_rels[i]),i=1..3)} = {0},
<a name="line_64"></a>  "u_rels = 0"
<a name="line_65"></a> );
<a name="line_66"></a>
<a name="line_67"></a> _ASSERT(
<a name="line_68"></a>  {seq(t_xyz_reduce(sn_rels[i]),i=1..8)} = {0},
<a name="line_69"></a>  "sn_rels = 0"
<a name="line_70"></a> );
<a name="line_71"></a>
<a name="line_72"></a> _ASSERT(
<a name="line_73"></a>  {seq(t_xyz_reduce(numer(factor(eval(subs({a=au,b=bu},ab_rels[i]))))),i=1..2)} = {0},
<a name="line_74"></a>  "ab_rels = 0"
<a name="line_75"></a> );
<a name="line_76"></a>
<a name="line_77"></a> _ASSERT(factor(expand({
<a name="line_78"></a>  ab_rels[3] - (1+a[2]^2)/2*((b[1]-2)*ab_rels[1]+(b[1]+2*a[1]^2)*ab_rels[2]),
<a name="line_79"></a>  ab_rels[4] - (1+a[1]^2)/2*((b[2]-2-8*a[2]^2)*ab_rels[1] + (b[2]-6*a[2]^2)*ab_rels[2]),
<a name="line_80"></a>  ab_rels[5] - (ab_rels[1] + ab_rels[2])/2,
<a name="line_81"></a>  ab_rels[6] - (b[1]*ab_rels[1] + (3*b[1]/4+a[1]^2)*ab_rels[2])/((b[1]+2)*(b[2]+2)+4),
<a name="line_82"></a>  ab_rels[7] - (ab_rels[2]/b[1]/8)
<a name="line_83"></a>  })) = {0},
<a name="line_84"></a>  "relations between ab_rels"
<a name="line_85"></a> );
<a name="line_86"></a>
<a name="line_87"></a> _ASSERT(
<a name="line_88"></a>  {op(map(t_xyz_reduce,extra_galois_rels))} = {0},
<a name="line_89"></a>  "extra_galois_rels = 0"
<a name="line_90"></a> );
<a name="line_91"></a>
<a name="line_92"></a> _ASSERT(
<a name="line_93"></a>  {seq(FNF_y0(tr[i]^2 - tx[i]^2),i=1..4),
<a name="line_94"></a>   seq(seq(simplify(
<a name="line_95"></a>    eval(subs(x = inner_quasirational_points[j],eval(subs({r=rx,y=yx0},tr[i]-tx[i]))))),
<a name="line_96"></a>     i=1..4),j=1..130)} = {0},
<a name="line_97"></a>  "formulae for t (up to sign) in terms of r and y[1]"
<a name="line_98"></a> );
<a name="line_99"></a>
<a name="line_100"></a> _ASSERT(map(t_xyz_reduce,{
<a name="line_101"></a>  y[1] - ys[1],
<a name="line_102"></a>  y[1] - ys_alt[1],
<a name="line_103"></a>  y[2] - ys[2],
<a name="line_104"></a>  z[1] - zs[1],
<a name="line_105"></a>  r[1] - rs[1],
<a name="line_106"></a>  r[2] - rs[2],
<a name="line_107"></a>  x[1] - xs[1],
<a name="line_108"></a>  x[2] - xs[2],
<a name="line_109"></a>  x[3] - xs[3],
<a name="line_110"></a>  x[4] - xs[4]
<a name="line_111"></a>  }) = {0},
<a name="line_112"></a>  "formulae for x,y,z,r in terms of s"
<a name="line_113"></a> );
<a name="line_114"></a>
<a name="line_115"></a> _ASSERT(map(t_xyz_reduce,{
<a name="line_116"></a>  x[1] - xt[1],
<a name="line_117"></a>  x[2] - xt[2],
<a name="line_118"></a>  x[3] - xt[3],
<a name="line_119"></a>  x[4] - xt[4],
<a name="line_120"></a>  y[1] - yt[1],
<a name="line_121"></a>  y[1] - yt_alt[1],
<a name="line_122"></a>  y[2] - yt[2],
<a name="line_123"></a>  z[1] - zt[1],
<a name="line_124"></a>  r[1] - rt[1],
<a name="line_125"></a>  r[2] - rt[2]
<a name="line_126"></a>  }) = {0},
<a name="line_127"></a>  "formulae for x,y,z,r in terms of t"
<a name="line_128"></a> );
<a name="line_129"></a>
<a name="line_130"></a> _ASSERT(
<a name="line_131"></a>  {seq(t_xyz_reduce(sx[i] - eval(subs(t = tx,st[i]))),i=1..16)} = {0},
<a name="line_132"></a>  "formulae for s in terms of t and in terms of x are consistent"
<a name="line_133"></a> );
<a name="line_134"></a>
<a name="line_135"></a> _ASSERT(
<a name="line_136"></a>  {seq(t_xyz_reduce(t[i] - eval(subs(u = ut,tu[i]))),i=1..4)} = {0},
<a name="line_137"></a>  "formulae for t in terms of u"
<a name="line_138"></a> );
<a name="line_139"></a> 
<a name="line_140"></a> _ASSERT(
<a name="line_141"></a>  {seq(t_xyz_reduce(s[i] - eval(subs(u = ut,su[i]))),i=1..16)} = {0},
<a name="line_142"></a>  "formulae for s in terms of u"
<a name="line_143"></a> );
<a name="line_144"></a> 
<a name="line_145"></a> _ASSERT(
<a name="line_146"></a>  map(uorb_AT,{op(BXYR)}) = {op(map(o -> {op(o)},BXYR_orbits))},
<a name="line_147"></a>  "orbits for G64 action on BXYR (up to sign)"
<a name="line_148"></a> );
<a name="line_149"></a>
<a name="line_150"></a> ok := true;
<a name="line_151"></a> 
<a name="line_152"></a> for chi in G64_chars do
<a name="line_153"></a>  for xi in G64_chars do
<a name="line_154"></a>   m0 := add(chi[i]*xi[i],i=1..64)/64;
<a name="line_155"></a>   m1 := `if`(chi = xi,1,0);
<a name="line_156"></a>   if m0 <> m1 then
<a name="line_157"></a>    ok := false;
<a name="line_158"></a>   fi;
<a name="line_159"></a>  od;
<a name="line_160"></a> od;
<a name="line_161"></a>
<a name="line_162"></a> _ASSERT(ok,"Orthogonality of characters for G64");
<a name="line_163"></a>
<a name="line_164"></a> _ASSERT(add(chi[1]^2,chi in G64_chars) = 64,
<a name="line_165"></a>         "Completeness of character table for G64");
<a name="line_166"></a>
<a name="line_167"></a>end:
<a name="line_168"></a>
<a name="line_169"></a>add_check(check_galois):
<a name="line_170"></a>
<a name="line_171"></a>######################################################################
<a name="line_172"></a>
<a name="line_173"></a>check_KR_subfields := proc()
<a name="line_174"></a> local i;
<a name="line_175"></a>
<a name="line_176"></a> printf("%a()\n",procname);
<a name="line_177"></a>
<a name="line_178"></a> for i in sort(map(op,[indices(KR_subfields)])) do
<a name="line_179"></a>  _ASSERT(KR_subfields[i]["check"],sprintf("KR_subfields[%d]",i));
<a name="line_180"></a> od;
<a name="line_181"></a>end:
<a name="line_182"></a>
<a name="line_183"></a>add_check(check_KR_subfields):  </pre>
 </body>
</html>
    